{% extends 'base.html.twig' %}

{% set page_header = contractor.name %}

{% block body %}
    <div class="container">
        <div class="panel-group">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4>
                        {{ contractor.name }}
                        <div class="btn-group pull-right" role="group">
                            <a href="{{ path('contractor_delete', {'contractor': contractor.id}) }}" class="btn-sm btn btn-danger">Удалить</a>
                        </div>
                    </h4>
                </div>
                <div class="panel-body">
                    <div class="row">
                        <div class="col-md-6">
                            <p><b>Инн:</b> {{ contractor.inn }}</p>
                        </div>
                        <div class="col-md-6">
                            <p><b>Тип контрагента:</b> {{ contractor.type == 'customer' ? 'Заказчик' : 'Поставщик' }}</p>
                        </div>

                    </div>
                    <div class="row">
                        {% if contractor.manager %}
                            <div class="col-md-6">
                                <p><b>Менеджер:</b> {{ contractor.manager.fullName }}</p>
                            </div>
                        {% endif %}
                        <div class="col-md-6">
                            <p><b>Организация:</b> {{ contractor.organisation.name|default }}</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4>
                        Оплата
                        <div class="pull-right">
                            <span class="label {{ balance > 0 ? 'label-success' : 'label-danger' }}">Баланс: {{ balance|number_format(2, '.', ' ')  }}</span>
                        </div>
                    </h4>
                </div>
                <div class="panel-body">
                    <table class="table">
                        <thead>
                        <tr>
                            <th>Дата</th>
                            <th>Сумма</th>
                            <th>Комментарий</th>
                            <th class="col-sm-1">&nbsp;</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for payment in contractor.payments %}
                            <tr>
                                <td>{{ payment.date|date('d.m.Y') }}</td>
                                <td>{{ payment.amount }}</td>
                                <td>{{ payment.comment }}</td>
                                <td><a href="{{ path('payment_delete', {'payment': payment.id}) }}" class="btn-sm btn btn-danger">Удалить</a></td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
                <div class="panel-footer">
                    <a href="{{ path('payment_create', {'contractor': contractor.id}) }}" class="btn btn-primary">Добавить оплату</a>
                </div>
            </div>
        </div>
    </div>
{% endblock %}